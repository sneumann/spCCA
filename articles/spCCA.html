<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="spCCA">
<title>Supervised Penalized Canonical Correlation Analysis with the spCCA package • spCCA</title>
<script src="../deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Supervised Penalized Canonical Correlation Analysis with the spCCA package">
<meta property="og:description" content="spCCA">
<!-- mathjax --><script src="file:///usr/share/javascript/mathjax/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spCCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/spCCA.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="spCCA_files/kePrint-0.0.1/kePrint.js"></script><link href="spCCA_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Supervised Penalized Canonical Correlation Analysis with the spCCA package</h1>
                        <h4 data-toc-skip class="author">Andrea
Thum</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:andrea.thum@informatik.uni-halle.de" class="email">andrea.thum@informatik.uni-halle.de</a>
      
                              <h4 data-toc-skip class="author">Steffen
Neumann</h4>
                  <a class="author_email" href="mailto:#"></a><a href="mailto:sneumann@ipb-halle.de" class="email">sneumann@ipb-halle.de</a>
      
                  
      
      
      <div class="d-none name"><code>spCCA.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>The supervised penalized canonical correlation approach (spCCA)
      is an extension of the penalized CCA, where the experimental
      design is used as a third data set (making the analysis
      supervised), and the correlation of the biological data sets with
      the design data set is maximized to find interpretable and
      meaningful canonical variables. This vignette shows the spCCA
      analysis on a data set of Arabidopsis thaliana with gene
      expression and metabolite intensity measurements, resulting in
      eight significant canonical variables.</p>
    </div>
    
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Attaching core tidyverse packages</span> ──────────────────────── tidyverse 2.0.0 ──</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr    </span> 1.1.4     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">readr    </span> 2.1.5</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">forcats  </span> 1.0.0     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">stringr  </span> 1.5.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2  </span> 3.5.1     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble   </span> 3.2.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">lubridate</span> 1.9.3     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr    </span> 1.3.1</span></span>
<span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr    </span> 1.0.2     </span></span>
<span><span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use the conflicted package (<span style="color: #0000BB; font-style: italic;">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'kableExtra'</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     group_rows</span></span></code></pre>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>See <span class="citation">[1]</span>.</p>
</div>
<div class="section level2">
<h2 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h2>
<p>We reduced the data sets by excluding features with low variance
(threshold chosen σ &lt; 1 for genes and σ &lt; 0.4 for metabolites),
resulting in a 72 × 252 LC/MS signal intensity matrix (X), and a 72 ×
1277 gene expression matrix (Y).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MTBLS18_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"arXiv.1405.1534"</span>, <span class="st">"MTBLS18.csv"</span>, </span>
<span>                            package <span class="op">=</span> <span class="st">"spCCA"</span><span class="op">)</span></span>
<span><span class="va">EMTAB3287_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"arXiv.1405.1534"</span>, <span class="st">"E-MTAB-3287.csv"</span>, </span>
<span>                                package <span class="op">=</span> <span class="st">"spCCA"</span><span class="op">)</span></span>
<span><span class="va">SAMEG179892_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"arXiv.1405.1534"</span>, <span class="st">"SAMEG179892.csv"</span>, </span>
<span>                                    package <span class="op">=</span> <span class="st">"spCCA"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Nicer order of the design factors </span></span>
<span><span class="va">classorder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pinf"</span>,</span>
<span>                <span class="st">"GL1"</span>,<span class="st">"Pen2Alone"</span>,<span class="st">"Erp1"</span>,<span class="st">"Erp2"</span>,<span class="st">"D"</span>,</span>
<span>                <span class="st">"DayNight"</span>,</span>
<span>                <span class="st">"Replicate2"</span>,<span class="st">"Replicate3"</span>,<span class="st">"Pinf.Culture3"</span>,<span class="st">"Pinf.Culture2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">MTBLS18_path</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">EMTAB3287_path</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">SAMEG179892_path</span>, row.names <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="va">classorder</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Enforce same sample names, re-using Metabolomics sample names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data-visualisation">Data visualisation<a class="anchor" aria-label="anchor" href="#data-visualisation"></a>
</h3>
<p>Show a graphical representation of the experimental design factors.
Then, check the distribution of values in the biological data sets.</p>
<p>TODO: double check x position of the samples and actual factor levels
for the experiments/samples.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span>,<span class="st">"DayNight"</span><span class="op">]</span><span class="op">*</span><span class="fl">0.9</span>, main<span class="op">=</span><span class="st">"Experimental Design Factors"</span>, type<span class="op">=</span><span class="st">"s"</span>, </span>
<span>     xlab<span class="op">=</span><span class="st">"Sample"</span>, ylab<span class="op">=</span><span class="st">""</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span>, xaxt<span class="op">=</span><span class="st">"n"</span>, yaxt<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, along<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, </span>
<span>     las<span class="op">=</span><span class="fl">2</span>, cex.axis<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">/</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, along<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span>, </span>
<span>     las<span class="op">=</span><span class="fl">2</span>, cex.axis<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">6.5</span>, along<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, by<span class="op">=</span><span class="fl">6</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"grey"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">12.5</span>, along<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, by<span class="op">=</span><span class="fl">12</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"grey"</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">i</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span><span class="va">dummy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span>,<span class="va">f</span><span class="op">]</span><span class="op">*</span><span class="fl">0.9</span><span class="op">+</span><span class="va">i</span>, col<span class="op">=</span><span class="va">i</span>, type<span class="op">=</span><span class="st">"s"</span><span class="op">)</span>; <span class="va">i</span><span class="op">&lt;&lt;-</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span> <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p><img src="spCCA_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">X</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, main<span class="op">=</span><span class="st">"Metabolites"</span>, xlab<span class="op">=</span><span class="st">"Intensity"</span>, ylab<span class="op">=</span><span class="st">"Density"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="spCCA_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Y</span>, freq<span class="op">=</span><span class="cn">FALSE</span>, main<span class="op">=</span><span class="st">"Transcripts"</span>, xlab<span class="op">=</span><span class="st">"Intensity"</span>, ylab<span class="op">=</span><span class="st">"Density"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="spCCA_files/figure-html/unnamed-chunk-2-3.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="spcca">spCCA<a class="anchor" aria-label="anchor" href="#spcca"></a>
</h2>
<p>Unsure how to perform the “ten-fold repeated hold-out sampling”
mentioned in the paper.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numCV</span> <span class="op">&lt;-</span> <span class="fl">6</span> <span class="co"># number of canonical variables to calculate</span></span>
<span></span>
<span><span class="co"># Define the grid size based on manpage</span></span>
<span><span class="va">end</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>,  <span class="fl">0.2</span>,  <span class="fl">2.0</span><span class="op">)</span></span>
<span><span class="va">step</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">CCA3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCCA3.html">getCCA3</a></span><span class="op">(</span>X<span class="op">=</span><span class="va">X</span>, Y<span class="op">=</span><span class="va">Y</span>, Z<span class="op">=</span><span class="va">Z</span>, </span>
<span>                numCV<span class="op">=</span><span class="va">numCV</span>,</span>
<span>                end<span class="op">=</span><span class="va">end</span>, step<span class="op">=</span><span class="va">step</span>,</span>
<span>                n.r <span class="op">=</span> <span class="fl">5</span>, <span class="co">## number of repeats, increase to 10 when parameters are stable</span></span>
<span>                max.counter.test <span class="op">=</span> <span class="fl">5</span> <span class="co">## number of random start vectors for iteration, increase to 10-20 when parameters are stable</span></span>
<span>                <span class="op">)</span>  </span>
<span></span>
<span><span class="co">#CCA3 &lt;- getCCA3(X=X, Y=Y, Z=Z, numCV=9, end=end, step=step)</span></span></code></pre></div>
<p>The higher the lambdas, the more sparse the canonical variables will
be.</p>
<p>The parameters for the lambda grid search depend on the number of
features (rows) in the data matrices.</p>
<p>The end value is inverse proportional to the number of features. For
the metabolomics data with n=252 rows, an end value of 1.0 could be a
good value. For the transcriptomics data with n=1277 rows, an end value
of 0.2 could be a good value. For the design matrix with n=11 design
factors, an end value of 2.0 could be a good value.</p>
<p>The step size is inverse proportional to the number of features. For
the metabolomics data with n=252 rows, a step size of 0.05 could be a
good value. For the transcriptomics data with n=1277 rows, a step size
of 0.01 or slightly smaller is a good value. For the design matrix with
n=11 design factors, a step size of 0.1 could be a good value.</p>
<p>step size 0.01 is a good number for sets with 1000 features</p>
<div class="section level3">
<h3 id="correlation-of-canonical-variables">Correlation of canonical variables<a class="anchor" aria-label="anchor" href="#correlation-of-canonical-variables"></a>
</h3>
<p>The correlation of the canonical variables is a measure how well the
experimental design explains the experimental data. A sharp drop in the
values can be a hint to use fewer canonical variables.</p>
<p>Unsure where to get significance threshold, must be somewhere in
<code><a href="../reference/get.best.lambdas.html">get.best.lambdas()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#plot(CCA3$corr, type="l")</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>along<span class="op">=</span><span class="va">CCA3</span><span class="op">$</span><span class="va">corr</span><span class="op">)</span>, y<span class="op">=</span><span class="va">CCA3</span><span class="op">$</span><span class="va">corr</span><span class="op">)</span>, </span>
<span>       mapping<span class="op">=</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="spCCA_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="../reference/plotCCA.html">plotCCA</a></span><span class="op">(</span><span class="va">CCA3</span>, <span class="va">X</span>, <span class="va">Y</span>, filename <span class="op">=</span> <span class="cn">NULL</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"metabolites"</span>, <span class="st">"genes"</span>, <span class="st">"design"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spCCA_files/figure-html/unnamed-chunk-4-1.png" width="700"><img src="spCCA_files/figure-html/unnamed-chunk-4-2.png" width="700"><img src="spCCA_files/figure-html/unnamed-chunk-4-3.png" width="700"><img src="spCCA_files/figure-html/unnamed-chunk-4-4.png" width="700"><img src="spCCA_files/figure-html/unnamed-chunk-4-5.png" width="700"><img src="spCCA_files/figure-html/unnamed-chunk-4-6.png" width="700"><img src="spCCA_files/figure-html/unnamed-chunk-4-7.png" width="700"><img src="spCCA_files/figure-html/unnamed-chunk-4-8.png" width="700"><img src="spCCA_files/figure-html/unnamed-chunk-4-9.png" width="700"><img src="spCCA_files/figure-html/unnamed-chunk-4-10.png" width="700"><img src="spCCA_files/figure-html/unnamed-chunk-4-11.png" width="700"><img src="spCCA_files/figure-html/unnamed-chunk-4-12.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="details-of-canonical-variables">Details of canonical variables<a class="anchor" aria-label="anchor" href="#details-of-canonical-variables"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numCV</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">topN</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.z</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.z</span><span class="op">[</span>,<span class="va">numCV</span><span class="op">]</span><span class="op">)</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="va">topN</span><span class="op">]</span>, <span class="va">numCV</span><span class="op">]</span>,</span>
<span>      digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="width: auto !important; ">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
x
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Pinf
</td>
<td style="text-align:right;">
0.696
</td>
</tr>
<tr>
<td style="text-align:left;">
Erp2
</td>
<td style="text-align:right;">
0.509
</td>
</tr>
<tr>
<td style="text-align:left;">
Pinf.Culture2
</td>
<td style="text-align:right;">
0.275
</td>
</tr>
<tr>
<td style="text-align:left;">
Pinf.Culture3
</td>
<td style="text-align:right;">
0.269
</td>
</tr>
<tr>
<td style="text-align:left;">
Erp1
</td>
<td style="text-align:right;">
0.236
</td>
</tr>
<tr>
<td style="text-align:left;">
Pen2Alone
</td>
<td style="text-align:right;">
0.221
</td>
</tr>
<tr>
<td style="text-align:left;">
DayNight
</td>
<td style="text-align:right;">
0.065
</td>
</tr>
<tr>
<td style="text-align:left;">
Replicate3
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Replicate2
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.x</span><span class="op">[</span>,<span class="va">numCV</span><span class="op">]</span><span class="op">)</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="va">topN</span><span class="op">]</span>, <span class="va">numCV</span><span class="op">]</span>,</span>
<span>      digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, position <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
x
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
M217T285
</td>
<td style="text-align:right;">
0.311
</td>
</tr>
<tr>
<td style="text-align:left;">
M249T195
</td>
<td style="text-align:right;">
0.298
</td>
</tr>
<tr>
<td style="text-align:left;">
M155T338
</td>
<td style="text-align:right;">
0.284
</td>
</tr>
<tr>
<td style="text-align:left;">
M201T406
</td>
<td style="text-align:right;">
0.280
</td>
</tr>
<tr>
<td style="text-align:left;">
M307T215
</td>
<td style="text-align:right;">
0.273
</td>
</tr>
<tr>
<td style="text-align:left;">
M144T409
</td>
<td style="text-align:right;">
0.253
</td>
</tr>
<tr>
<td style="text-align:left;">
M217T326
</td>
<td style="text-align:right;">
0.249
</td>
</tr>
<tr>
<td style="text-align:left;">
M321T229
</td>
<td style="text-align:right;">
0.234
</td>
</tr>
<tr>
<td style="text-align:left;">
M155T236
</td>
<td style="text-align:right;">
0.227
</td>
</tr>
<tr>
<td style="text-align:left;">
M391T510
</td>
<td style="text-align:right;">
0.221
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.y</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.y</span><span class="op">[</span>,<span class="va">numCV</span><span class="op">]</span><span class="op">)</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="va">topN</span><span class="op">]</span>, <span class="va">numCV</span><span class="op">]</span>,</span>
<span>      digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="width: auto !important; margin-right: 0; margin-left: auto">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
x
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
X263948_at
</td>
<td style="text-align:right;">
0.103
</td>
</tr>
<tr>
<td style="text-align:left;">
X267567_at
</td>
<td style="text-align:right;">
0.101
</td>
</tr>
<tr>
<td style="text-align:left;">
X249481_at
</td>
<td style="text-align:right;">
0.099
</td>
</tr>
<tr>
<td style="text-align:left;">
X253099_s_at
</td>
<td style="text-align:right;">
0.095
</td>
</tr>
<tr>
<td style="text-align:left;">
X258277_at
</td>
<td style="text-align:right;">
0.095
</td>
</tr>
<tr>
<td style="text-align:left;">
X261005_at
</td>
<td style="text-align:right;">
0.095
</td>
</tr>
<tr>
<td style="text-align:left;">
X266267_at
</td>
<td style="text-align:right;">
0.095
</td>
</tr>
<tr>
<td style="text-align:left;">
X261021_at
</td>
<td style="text-align:right;">
0.094
</td>
</tr>
<tr>
<td style="text-align:left;">
X261216_at
</td>
<td style="text-align:right;">
0.093
</td>
</tr>
<tr>
<td style="text-align:left;">
X259403_at
</td>
<td style="text-align:right;">
0.092
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="join-the-tidyverse">Join the tidyverse<a class="anchor" aria-label="anchor" href="#join-the-tidyverse"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine the lists into a single data frame</span></span>
<span></span>
<span><span class="va">canVars</span> <span class="op">=</span> <span class="fu">as.tibble</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>canVar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>along<span class="op">=</span><span class="va">CCA3</span><span class="op">$</span><span class="va">corr</span><span class="op">)</span>, corr <span class="op">=</span> <span class="va">CCA3</span><span class="op">$</span><span class="va">corr</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `as.tibble()` was deprecated in tibble 2.0.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `as_tibble()` instead.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> The signature and semantics have changed, see `?as_tibble`.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambdas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"Z"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                 <span class="va">CCA3</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">lambdas</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matrix"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">lambdas</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert lambdas from wide to long tibble</span></span>
<span><span class="va">lambdas_long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">as_tibble</span><span class="op">(</span><span class="va">lambdas</span><span class="op">)</span>, </span>
<span>                             cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">lambdas</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             names_to<span class="op">=</span><span class="st">"canVar"</span>,</span>
<span>                             names_transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>canVar <span class="op">=</span> <span class="va">as.integer</span><span class="op">)</span>,</span>
<span>                             values_to<span class="op">=</span><span class="st">"lambda"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Convert the data frame to a tibble</span></span>
<span><span class="va">combined_tibble</span> <span class="op">&lt;-</span> <span class="fu">inner_join</span><span class="op">(</span><span class="va">canVars</span>, <span class="va">lambdas_long</span>, by<span class="op">=</span><span class="st">"canVar"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the tibble</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">combined_tibble</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 18 × 4</span></span></span>
<span><span class="co">##    canVar  corr matrix lambda</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>      1 0.945 X        0.25</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>      1 0.945 Y        0.07</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>      1 0.945 Z        0.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>      2 0.956 X        0.2 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>      2 0.956 Y        0.09</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>      2 0.956 Z        0   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>      3 0.939 X        0.2 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>      3 0.939 Y        0.08</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>      3 0.939 Z        0.2 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>      4 0.895 X        0.2 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>      4 0.895 Y        0.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>      4 0.895 Z        0.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span>      5 0.829 X        0.2 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span>      5 0.829 Y        0.14</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span>      5 0.829 Z        0   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span>      6 0.865 X        0.3 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span>      6 0.865 Y        0.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span>      6 0.865 Z        0.4</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="join-the-tidyverse-1">Join the tidyverse<a class="anchor" aria-label="anchor" href="#join-the-tidyverse-1"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">canVarX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix<span class="op">=</span><span class="st">"X"</span>, sampleName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.CV.x</span><span class="op">)</span>, <span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.CV.x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">canVarX</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matrix"</span>, <span class="st">"sampleName"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">canVarX</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">canVarY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix<span class="op">=</span><span class="st">"Y"</span>, sampleName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.CV.y</span><span class="op">)</span>, <span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.CV.y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">canVarY</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matrix"</span>, <span class="st">"sampleName"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">canVarY</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">canVarZ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix<span class="op">=</span><span class="st">"Z"</span>, sampleName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.CV.z</span><span class="op">)</span>, <span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.CV.z</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">canVarZ</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matrix"</span>, <span class="st">"sampleName"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">canVarZ</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">canVar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">canVarX</span>, <span class="va">canVarY</span>, <span class="va">canVarZ</span><span class="op">)</span></span>
<span></span>
<span><span class="va">canVar_long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">as.tibble</span><span class="op">(</span><span class="va">canVar</span><span class="op">)</span>,</span>
<span>                             cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">canVar</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                        names_to<span class="op">=</span><span class="st">"canVar"</span>,</span>
<span>                        names_transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>canVar <span class="op">=</span> <span class="va">as.integer</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ggplot canVar_long for each matrix for canVar==1</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">canVar_long</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">canVar</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>       mapping<span class="op">=</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">sampleName</span>, y <span class="op">=</span> <span class="va">value</span>, color<span class="op">=</span><span class="va">matrix</span>, group<span class="op">=</span><span class="va">matrix</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_step</span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"mid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spCCA_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="join-the-tidyverse-2">Join the tidyverse<a class="anchor" aria-label="anchor" href="#join-the-tidyverse-2"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weightsX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix<span class="op">=</span><span class="st">"X"</span>, featureName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.x</span><span class="op">)</span>, <span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">weightsX</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matrix"</span>, <span class="st">"featureName"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">weightsX</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weightsY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix<span class="op">=</span><span class="st">"Y"</span>, featureName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.y</span><span class="op">)</span>, <span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">weightsY</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matrix"</span>, <span class="st">"featureName"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">weightsY</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weightsZ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix<span class="op">=</span><span class="st">"Z"</span>, featureName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.z</span><span class="op">)</span>, <span class="va">CCA3</span><span class="op">$</span><span class="va">cc3.weight.z</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">weightsZ</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matrix"</span>, <span class="st">"featureName"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">weightsZ</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">weightsX</span>, <span class="va">weightsY</span>, <span class="va">weightsZ</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weights_long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">as.tibble</span><span class="op">(</span><span class="va">weights</span><span class="op">)</span>,</span>
<span>                             cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">weights</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                        names_to<span class="op">=</span><span class="st">"canVar"</span>,</span>
<span>                        names_transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>canVar <span class="op">=</span> <span class="va">as.integer</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu">as.tibble</span><span class="op">(</span><span class="fu">bind_rows</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix<span class="op">=</span><span class="st">"X"</span>, featureName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix<span class="op">=</span><span class="st">"Y"</span>, featureName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>matrix<span class="op">=</span><span class="st">"Z"</span>, featureName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">values_long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">values</span>,</span>
<span>                             cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             names_to<span class="op">=</span><span class="st">"sampleName"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## for each matrix, for each canVar, obtain the featureNames of the features with the hightest weights</span></span>
<span><span class="va">topN</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">topFeatures</span> <span class="op">&lt;-</span> <span class="va">weights_long</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">matrix</span> <span class="op">!=</span> <span class="st">"Z"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">matrix</span>, <span class="va">canVar</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">top_n</span><span class="op">(</span><span class="va">topN</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">matrix</span>, <span class="va">canVar</span>, <span class="fu">desc</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## for Each topFeature, multiply the corresponding value_long with the weight</span></span>
<span><span class="va">topFeatures_values</span> <span class="op">&lt;-</span> <span class="fu">inner_join</span><span class="op">(</span><span class="va">topFeatures</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">canVar</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                                 <span class="va">values_long</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"matrix"</span>, <span class="st">"featureName"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>weightedValue <span class="op">=</span> <span class="va">value.x</span><span class="op">*</span><span class="va">value.y</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ggplot topFeatures_values for each matrix for canVar==1</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">topFeatures_values</span>, </span>
<span>       mapping<span class="op">=</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">sampleName</span>, y <span class="op">=</span> <span class="va">weightedValue</span>, color<span class="op">=</span><span class="va">featureName</span>, group<span class="op">=</span><span class="va">featureName</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_step</span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"mid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="spCCA_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="saving-results">Saving results<a class="anchor" aria-label="anchor" href="#saving-results"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/save.CCA.html">save.CCA</a></span><span class="op">(</span><span class="va">CCA3</span>, file<span class="op">=</span><span class="st">"CCA3"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<pre><code><span><span class="co">## R version 4.3.3 (2024-02-29)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.1 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Berlin</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] kableExtra_1.4.0 knitr_1.48       lubridate_1.9.3  forcats_1.0.0   </span></span>
<span><span class="co">##  [5] stringr_1.5.1    dplyr_1.1.4      purrr_1.0.2      readr_2.1.5     </span></span>
<span><span class="co">##  [9] tidyr_1.3.1      tibble_3.2.1     ggplot2_3.5.1    tidyverse_2.0.0 </span></span>
<span><span class="co">## [13] spCCA_0.1.6      BiocStyle_2.30.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] gtable_0.3.6        xfun_0.48           bslib_0.8.0        </span></span>
<span><span class="co">##  [4] tzdb_0.4.0          vctrs_0.6.5         tools_4.3.3        </span></span>
<span><span class="co">##  [7] generics_0.1.3      fansi_1.0.6         highr_0.11         </span></span>
<span><span class="co">## [10] pkgconfig_2.0.3     desc_1.4.3          lifecycle_1.0.4    </span></span>
<span><span class="co">## [13] compiler_4.3.3      farver_2.1.2        textshaping_0.3.7  </span></span>
<span><span class="co">## [16] munsell_0.5.1       codetools_0.2-19    htmltools_0.5.8.1  </span></span>
<span><span class="co">## [19] sass_0.4.9          yaml_2.3.10         pillar_1.9.0       </span></span>
<span><span class="co">## [22] pkgdown_2.0.7       crayon_1.5.3        jquerylib_0.1.4    </span></span>
<span><span class="co">## [25] MASS_7.3-60.0.1     cachem_1.1.0        tidyselect_1.2.1   </span></span>
<span><span class="co">## [28] digest_0.6.37       stringi_1.8.4       bookdown_0.37      </span></span>
<span><span class="co">## [31] labeling_0.4.3      fastmap_1.2.0       grid_4.3.3         </span></span>
<span><span class="co">## [34] colorspace_2.1-1    cli_3.6.3           magrittr_2.0.3     </span></span>
<span><span class="co">## [37] utf8_1.2.4          withr_3.0.2         scales_1.3.0       </span></span>
<span><span class="co">## [40] timechange_0.3.0    rmarkdown_2.28      ragg_1.2.7         </span></span>
<span><span class="co">## [43] hms_1.1.3           memoise_2.0.1       evaluate_1.0.1     </span></span>
<span><span class="co">## [46] viridisLite_0.4.2   rlang_1.1.4         glue_1.8.0         </span></span>
<span><span class="co">## [49] BiocManager_1.30.25 xml2_1.3.6          svglite_2.1.3      </span></span>
<span><span class="co">## [52] rstudioapi_0.15.0   jsonlite_1.8.9      R6_2.5.1           </span></span>
<span><span class="co">## [55] systemfonts_1.0.5   fs_1.6.4</span></span></code></pre>
<div id="refs" class="references csl-bib-body">
<div id="ref-Hotel36" class="csl-entry">
1. Hotelling H: <strong>Relations between two sets of variates</strong>.
<em>Biometrika</em> 1936, <strong>28</strong>:321–377.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Steffen Neumann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
